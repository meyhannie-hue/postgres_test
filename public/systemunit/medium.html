<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Computer Port Labeling</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: #121212;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      overflow-y: auto;
      overflow-x: hidden;
      position: relative;
      color: #f5f5f5;
    }
    
    /* Blueprint Grid Background */
    .blueprint-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      background-image: 
        linear-gradient(rgba(255, 145, 0, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 145, 0, 0.05) 1px, transparent 1px),
        linear-gradient(rgba(207, 216, 220, 0.03) 2px, transparent 2px),
        linear-gradient(90deg, rgba(207, 216, 220, 0.03) 2px, transparent 2px);
      background-size: 20px 20px, 20px 20px, 40px 40px, 40px 40px;
    }
    
    /* Circuit Pattern Overlay */
    .circuit-pattern {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.1;
      pointer-events: none;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(255, 145, 0, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 80% 80%, rgba(255, 145, 0, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 40% 40%, rgba(207, 216, 220, 0.05) 0%, transparent 15%);
    }
    
    .app-container, .instructions-container {
      width: 100%;
      max-width: 1000px;
      background: rgba(33, 33, 33, 0.9);
      border-radius: 10px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      margin: 20px 0;
      border: 1px solid rgba(207, 216, 220, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    /* Blueprint corners */
    .app-container::before, .instructions-container::before {
      content: '';
      position: absolute;
      top: 10px;
      left: 10px;
      right: 10px;
      bottom: 10px;
      border: 1px solid rgba(255, 145, 0, 0.3);
      border-radius: 6px;
      pointer-events: none;
      z-index: 1;
    }
    
    /* Blueprint corner decorations */
    .blueprint-corner {
      position: absolute;
      width: 20px;
      height: 20px;
      border-color: #ff9100;
      border-style: solid;
      border-width: 0;
      z-index: 2;
    }
    
    .blueprint-corner.tl {
      top: 10px;
      left: 10px;
      border-top-width: 2px;
      border-left-width: 2px;
    }
    
    .blueprint-corner.tr {
      top: 10px;
      right: 10px;
      border-top-width: 2px;
      border-right-width: 2px;
    }
    
    .blueprint-corner.bl {
      bottom: 10px;
      left: 10px;
      border-bottom-width: 2px;
      border-left-width: 2px;
    }
    
    .blueprint-corner.br {
      bottom: 10px;
      right: 10px;
      border-bottom-width: 2px;
      border-right-width: 2px;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: rgba(33, 33, 33, 0.8);
      color: #f5f5f5;
      padding: 15px 20px;
      position: relative;
      z-index: 2;
      border-bottom: 1px solid rgba(207, 216, 220, 0.2);
    }
    
    .header-title {
      font-size: 20px;
      flex-grow: 1;
      text-align: center;
      font-weight: bold;
      color: #cfd8dc;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .back-button { 
      cursor: pointer; 
      font-size: 20px; 
      color: #ff9100;
      transition: transform 0.2s ease, color 0.3s ease;
    }
    
    .back-button:hover { 
      transform: scale(1.2) rotate(-30deg); 
      color: #ffb74d;
    }
    
    .placeholder { width: 30px; }
    
    /* Instructions Styles */
    .instructions-content {
      padding: 30px;
      font-family: 'Poppins', sans-serif;
      position: relative;
      z-index: 2;
    }
    
    .instructions-content h2 {
      color: #ff9100;
      text-align: center;
      margin-top: 0;
      margin-bottom: 30px;
      font-size: 28px;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .instructions-text {
      background: rgba(33, 33, 33, 0.7);
      padding: 20px;
      border-radius: 8px;
      border: 1px solid rgba(207, 216, 220, 0.2);
      margin-bottom: 30px;
      line-height: 1.6;
    }
    
    .instructions-text p {
      margin: 15px 0;
    }
    
    .instructions-text ul {
      padding-left: 20px;
    }
    
    .instructions-text li {
      margin: 10px 0;
    }
    
    .port-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin: 30px 0;
    }
    
    .port-item {
      display: flex;
      align-items: center;
      background: rgba(33, 33, 33, 0.7);
      padding: 10px 15px;
      border-radius: 8px;
      border: 1px solid rgba(207, 216, 220, 0.2);
      max-width: 45%;
    }
    
    .port-icon {
      width: 40px;
      height: 40px;
      background: rgba(255, 145, 0, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      color: #ff9100;
      font-weight: bold;
      font-size: 14px;
    }
    
    .port-name {
      font-weight: 600;
      color: #cfd8dc;
      font-size: 14px;
    }
    
    .start-button {
      display: block;
      margin: 30px auto;
      padding: 15px 30px;
      font-size: 18px;
      font-weight: bold;
      background: linear-gradient(45deg, #ff9100, #ff5722);
      color: #f5f5f5;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 15px rgba(255, 145, 0, 0.3);
      transition: all 0.3s ease;
    }
    
    .start-button:hover {
      background: linear-gradient(45deg, #ffb74d, #ff7043);
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(255, 145, 0, 0.4);
    }
    
    .container {
      position: relative;
      display: inline-block;
      width: 100%;
      max-width: 1000px;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      overflow: hidden;
      background: rgba(33, 33, 33, 0.7);
      border: 3px solid #cfd8dc;
      animation: fadeIn 1s ease forwards;
      margin: 20px;
      min-height: 800px;
      position: relative;
      z-index: 2;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .container img {
      width: 100%;
      height: 800px;
      display: block;
      object-fit: fill;
    }
    
    .drop-zone {
      position: absolute;
      background: rgba(33, 33, 33, 0.7);
      border: 2px dashed #cfd8dc;
      border-radius: 10px;
      font-weight: 500;
      font-size: 16px;
      text-align: center;
      color: #f5f5f5;
      width: 20%;
      height: 12%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      overflow: hidden;
      padding: 10px;
      box-sizing: border-box;
    }
    
    .drop-zone:hover {
      background: rgba(255, 145, 0, 0.2);
      border-color: #ff9100;
      box-shadow: 0 0 15px rgba(255, 145, 0, 0.5);
      transform: scale(1.03);
    }
    
    .drop-zone.correct {
      background: rgba(0, 255, 0, 0.2);
      border: 2px solid rgba(0, 255, 0, 0.7);
      color: #00ff00;
      animation: magneticSnap 0.5s ease;
    }
    
    .drop-zone.incorrect {
      background: rgba(255, 0, 0, 0.2);
      border: 2px solid rgba(255, 0, 0, 0.7);
      color: #ff3333;
      animation: shake 0.5s;
    }
    
    @keyframes magneticSnap {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    
    /* Positions in % relative to the image */
    .ps2         { top: 42%; left: 3%; }
    .serial      { top: 52%; left: 3%; }
    .vga         { top: 62%; left: 3%; }
    .usb         { top: 72%; left: 3%; }
    .audio       { top: 89%; left: 3%; }
    .powersupply { top: 28%; left: 74%; }
    .parallel    { top: 56%; left: 76%; }
    .rj45        { top: 75%; left: 79%; }
    
    .choices {
      margin-top: 30px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      animation: fadeIn 1.2s ease forwards;
      padding: 0 20px;
      max-width: 1000px;
      width: 100%;
      box-sizing: border-box;
      position: relative;
      z-index: 2;
    }
    
    .choice {
      background: linear-gradient(135deg, #cfd8dc, #90a4ae);
      padding: 14px 20px;
      border-radius: 10px;
      font-size: 18px;
      cursor: grab;
      border: 1px solid #cfd8dc;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      color: #212121;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .choice:hover {
      background: linear-gradient(135deg, #ff9100, #ff5722);
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(255, 145, 0, 0.3);
      border-color: #ff9100;
      color: #f5f5f5;
    }
    
    .choice:active {
      cursor: grabbing;
      transform: translateY(-2px);
    }
    
    .button-container {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      gap: 20px;
      animation: fadeIn 1.4s ease forwards;
      background: rgba(33, 33, 33, 0.7);
      padding: 15px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(207, 216, 220, 0.2);
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      margin-bottom: 20px;
      position: relative;
      z-index: 2;
    }
    
    .btn {
      padding: 14px 26px;
      font-size: 18px;
      font-weight: 600;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
      letter-spacing: 1px;
      flex: 1;
      max-width: 200px;
      font-family: 'Orbitron', sans-serif;
    }
    
    .btn-submit {
      background: linear-gradient(45deg, #cfd8dc, #90a4ae);
      color: #212121;
      box-shadow: 0 4px 15px rgba(207, 216, 220, 0.3);
    }
    
    .btn-submit:hover {
      background: linear-gradient(45deg, #ff9100, #ff5722);
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(255, 145, 0, 0.5);
      color: #f5f5f5;
    }
    
    /* Hide game container initially */
    #gameContainer {
      display: none;
    }
    
    /* Mobile responsiveness */
    @media (max-width: 600px) {
      .app-container, .instructions-container { 
        border-radius: 0;
        min-height: 100vh;
        height: auto;
        margin: 0;
        width: 100%;
        max-width: 100%;
      }
      
      header {
        border-radius: 0;
      }
      
      .header-title {
        font-size: 16px;
      }
      
      .container {
        max-width: 100%;
        border-radius: 0;
        margin: 0;
        min-height: 400px;
        border-width: 2px;
      }
      
      .container img {
        height: 400px;
      }
      
      .drop-zone {
        font-size: 14px;
        height: 10%;
        border-radius: 6px;
        padding: 8px;
        width: 21%;
      }
      
      .choice {
        padding: 10px 14px;
        font-size: 14px;
        border-radius: 6px;
      }
      
      .button-container {
        flex-direction: column;
        gap: 10px;
        padding: 10px;
      }
      
      .btn {
        width: 100%;
        max-width: none;
        padding: 12px 18px;
        font-size: 16px;
      }
      
      .back-button {
        font-size: 18px;
      }
      
      .instructions-content {
        padding: 20px;
      }
      
      .instructions-content h2 {
        font-size: 22px;
      }
      
      .port-item {
        flex-direction: column;
        text-align: center;
        max-width: 100%;
      }
      
      .port-icon {
        margin-right: 0;
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="blueprint-bg"></div>
  <div class="circuit-pattern"></div>
  
  <!-- Instructions Container -->
  <div class="instructions-container" id="instructionsContainer">
    <div class="blueprint-corner tl"></div>
    <div class="blueprint-corner tr"></div>
    <div class="blueprint-corner bl"></div>
    <div class="blueprint-corner br"></div>
    
    <header>
      <div class="back-button" onclick="confirmBack()">â¤º</div>
      <div class="header-title">ðŸ”Œ Computer Port Identification</div>
      <div class="placeholder"></div>
    </header>
    
    <div class="instructions-content">
      <h2>Port Identification Blueprint</h2>
      
      <div class="instructions-text">
        <p>Welcome to the Tech Lab! Your mission is to identify and correctly label the various ports on the back of a computer case.</p>
        
        <h3 style="color: #ff9100; margin-top: 20px;">Mission Briefing:</h3>
        <p>This interactive simulation will test your knowledge of computer ports and their proper identification.</p>
        
        <h3 style="color: #ff9100; margin-top: 20px;">Ports to Identify:</h3>
        <div class="port-list">
          <div class="port-item">
            <div class="port-icon">PS2</div>
            <div class="port-name">Ps/2 ports</div>
          </div>
          <div class="port-item">
            <div class="port-icon">COM</div>
            <div class="port-name">Serial port</div>
          </div>
          <div class="port-item">
            <div class="port-icon">VGA</div>
            <div class="port-name">VGA Video</div>
          </div>
          <div class="port-item">
            <div class="port-icon">USB</div>
            <div class="port-name">USB Ports</div>
          </div>
        </div>
        
        <h3 style="color: #ff9100; margin-top: 20px;">Instructions:</h3>
        <ul>
          <li>Drag each port label from the selection area to its correct position on the computer case</li>
          <li>Labels will snap into place with a magnetic animation when correctly positioned</li>
          <li>Hover over drop zones to see them glow orange</li>
          <li>Click Submit when you believe all labels are correctly placed</li>
          <li>Earn points based on the number of correctly identified ports</li>
        </ul>
        
        <h3 style="color: #ff9100; margin-top: 20px;">Rewards:</h3>
        <p>Successfully identifying all ports will earn you maximum points. Each correctly labeled port contributes to your total score.</p>
      </div>
      
      <button class="start-button" onclick="startGame()">ðŸš€ Start Identification</button>
    </div>
  </div>
  
  <!-- Game Container -->
  <div class="app-container" id="gameContainer">
    <div class="blueprint-corner tl"></div>
    <div class="blueprint-corner tr"></div>
    <div class="blueprint-corner bl"></div>
    <div class="blueprint-corner br"></div>
    
    <header>
      <div class="back-button" onclick="confirmBack()">â¤º</div>
      <div class="header-title">ðŸ”Œ Computer Port Identification</div>
      <div class="placeholder"></div>
    </header>
    
    <div class="container">
      <img src="images/medium.png" alt="Computer Back Ports">
      <div class="drop-zone ps2"         data-correct="Ps/2 ports" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="drop-zone serial"      data-correct="Serial port" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="drop-zone vga"         data-correct="VGA Video" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="drop-zone usb"         data-correct="USB Ports" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="drop-zone audio"       data-correct="Audio Jacks" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="drop-zone powersupply" data-correct="Power Supply" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="drop-zone parallel"    data-correct="Parallel Port" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
      <div class="drop-zone rj45"        data-correct="RJ45 NIC" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
    </div>
    
    <div class="choices">
      <div class="choice" draggable="true" id="Ps/2 ports" ondragstart="drag(event)">Ps/2 ports</div>
      <div class="choice" draggable="true" id="Serial port" ondragstart="drag(event)">Serial port</div>
      <div class="choice" draggable="true" id="VGA Video" ondragstart="drag(event)">VGA Video</div>
      <div class="choice" draggable="true" id="USB Ports" ondragstart="drag(event)">USB Ports</div>
      <div class="choice" draggable="true" id="Audio Jacks" ondragstart="drag(event)">Audio Jacks</div>
      <div class="choice" draggable="true" id="Power Supply" ondragstart="drag(event)">Power Supply</div>
      <div class="choice" draggable="true" id="Parallel Port" ondragstart="drag(event)">Parallel Port</div>
      <div class="choice" draggable="true" id="RJ45 NIC" ondragstart="drag(event)">RJ45 NIC</div>
    </div>
    
    <div class="button-container">
      <button class="btn btn-submit" onclick="submitAnswers()">
        <span>Submit âœ“</span>
      </button>
    </div>
  </div>
  
  <script>
    // Original functionality with enhancements
    function allowDrop(ev) {
      ev.preventDefault();
    }
    
    function drag(ev) {
      ev.dataTransfer.setData("text", ev.target.id);
    }
    
    function drop(ev) {
      ev.preventDefault();
      const data = ev.dataTransfer.getData("text");
      const dragged = document.getElementById(data);
      const target = ev.target;
      
      // Check if target already has a choice
      if (target.querySelector('.choice')) return;
      
      // Remove previous correct/incorrect classes
      target.classList.remove("correct", "incorrect");
      
      // Check if the drop is correct
      if (target.dataset.correct === data) {
        target.classList.add("correct");
        // Add magnetic snap animation
        target.style.animation = "magneticSnap 0.5s ease";
        setTimeout(() => {
          target.style.animation = "";
        }, 500);
      } else {
        target.classList.add("incorrect");
      }
      
      // Clear the target and append the dragged element
      target.textContent = "";
      target.appendChild(dragged);
      dragged.draggable = false;
      dragged.style.cursor = "default";
    }
    
    function confirmBack() {
      if (confirm("âš ï¸ Are you sure you want to go back? Progress will be lost.")) {
        window.history.back();
      }
    }
    
    function startGame() {
      document.getElementById('instructionsContainer').style.display = 'none';
      document.getElementById('gameContainer').style.display = 'flex';
    }
    
    function submitAnswers() {
      const zones = document.querySelectorAll(".drop-zone");
      let correctCount = 0;
      zones.forEach(zone => {
        const choice = zone.querySelector(".choice");
        if (choice && zone.dataset.correct === choice.id) {
          correctCount++;
        }
      });
      const total = zones.length;
      const points = correctCount * 200;
      const coins = correctCount * 20;
      
      if (correctCount === total) {
        alert(`ðŸŽ¯ Perfect! You got all ${total} correct.\nðŸ† +${points} points and ${coins} coins`);
      } else {
        alert(`âœ… You got ${correctCount} out of ${total} correct.\nðŸŽ¯ +${points} points and ${coins} coins`);
      }
      
      // Send reward to server
      const username = localStorage.getItem("loggedInUser") || "Guest";
      
      fetch("https://postgres-test-p05s.onrender.com/api/reward", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ 
          username, 
          points, 
          coins,
          reason: "Computer Port Identification"
        })
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          console.log("Reward sent successfully");
        } else {
          console.error("Failed to send reward:", data);
        }
      })
      .catch(err => {
        console.error("Error sending reward:", err);
      });
      
      // Update local storage
      let playerPoints = parseInt(localStorage.getItem("player_points") || "0");
      playerPoints += points;
      localStorage.setItem("player_points", playerPoints.toString());
    }
    // === ðŸŽµ SYSTEM UNIT LAB AMBIENCE ===
let sysAudioCtx, sysMasterGain, sysIntervals = [];

function startSystemUnitMusic() {
  if (sysAudioCtx) return; // already playing

  sysAudioCtx = new (window.AudioContext || window.webkitAudioContext)();
  sysMasterGain = sysAudioCtx.createGain();
  sysMasterGain.gain.value = 0.6; // ðŸŽš lower ambient volume
  sysMasterGain.connect(sysAudioCtx.destination);

  // ðŸ”¹ Ambient low hum (feels like PC fans or lab machines running)
  sysIntervals.push(setInterval(() => {
    playToneSys(80, "sawtooth", 2, 0.15);
  }, 2000));

  // ðŸ”¹ Random digital beeps (assembly scanner sounds)
  sysIntervals.push(setInterval(() => {
    let freqs = [523, 659, 784, 988]; // high-tech tones
    let freq = freqs[Math.floor(Math.random() * freqs.length)];
    playToneSys(freq, "triangle", 0.2, 0.25);
  }, 1200));

  // ðŸ”¹ Metallic click / clank (like snapping PC parts in)
  sysIntervals.push(setInterval(() => {
    playClickSys();
  }, 2500));
}

// === SOUND HELPERS ===
function playToneSys(freq, type, duration, volume) {
  const osc = sysAudioCtx.createOscillator();
  const gain = sysAudioCtx.createGain();
  gain.gain.value = volume;
  osc.type = type;
  osc.frequency.value = freq;
  osc.connect(gain);
  gain.connect(sysMasterGain);

  osc.start();
  osc.stop(sysAudioCtx.currentTime + duration);
}

function playClickSys() {
  const bufferSize = sysAudioCtx.sampleRate * 0.05;
  const buffer = sysAudioCtx.createBuffer(1, bufferSize, sysAudioCtx.sampleRate);
  const data = buffer.getChannelData(0);

  for (let i = 0; i < bufferSize; i++) {
    data[i] = Math.random() * 2 - 1; // noise
  }

  const noise = sysAudioCtx.createBufferSource();
  noise.buffer = buffer;

  const gain = sysAudioCtx.createGain();
  gain.gain.value = 0.2;
  noise.connect(gain);
  gain.connect(sysMasterGain);

  noise.start();
  noise.stop(sysAudioCtx.currentTime + 0.05);
}

// === STOP ===
function stopSystemUnitMusic() {
  sysIntervals.forEach(id => clearInterval(id));
  sysIntervals = [];
  if (sysAudioCtx) {
    sysAudioCtx.close();
    sysAudioCtx = null;
  }
}

// === AUTO START ===
window.addEventListener("load", () => {
  // Some browsers require a user interaction â€” this ensures auto-start after first click
  document.body.addEventListener("click", () => {
    if (!sysAudioCtx) startSystemUnitMusic();
  }, { once: true });

  // If autoplay is allowed, try directly
  startSystemUnitMusic();
});
  </script>
</body>
</html>