<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Motherboard Label Drag & Drop</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: #212121;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    overflow-y: auto;
    overflow-x: hidden;
    position: relative;
    color: #f5f5f5;
  }
    
    /* Blueprint Grid Background */
    .blueprint-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      background-image: 
        linear-gradient(rgba(255, 145, 0, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 145, 0, 0.05) 1px, transparent 1px),
        linear-gradient(rgba(207, 216, 220, 0.03) 2px, transparent 2px),
        linear-gradient(90deg, rgba(207, 216, 220, 0.03) 2px, transparent 2px);
      background-size: 20px 20px, 20px 20px, 40px 40px, 40px 40px;
    }
    
    /* Circuit Pattern Overlay */
    .circuit-pattern {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.1;
      pointer-events: none;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(255, 145, 0, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 80% 80%, rgba(255, 145, 0, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 40% 40%, rgba(207, 216, 220, 0.05) 0%, transparent 15%);
    }
    
    body {
      flex-direction: column;
    }
    
    .app-container, .instructions-container {
      flex: 1;
      width: 100%;
      max-width: 1200px;
      background: rgba(33, 33, 33, 0.9);
      border-radius: 10px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      padding-bottom: 40px;
      margin: 20px 0;
      border: 1px solid rgba(207, 216, 220, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    /* Blueprint corners */
    .app-container::before, .instructions-container::before {
      content: '';
      position: absolute;
      top: 10px;
      left: 10px;
      right: 10px;
      bottom: 10px;
      border: 1px solid rgba(255, 145, 0, 0.3);
      border-radius: 6px;
      pointer-events: none;
      z-index: 1;
    }
    
    /* Blueprint corner decorations */
    .blueprint-corner {
      position: absolute;
      width: 20px;
      height: 20px;
      border-color: #ff9100;
      border-style: solid;
      border-width: 0;
      z-index: 2;
    }
    
    .blueprint-corner.tl {
      top: 10px;
      left: 10px;
      border-top-width: 2px;
      border-left-width: 2px;
    }
    
    .blueprint-corner.tr {
      top: 10px;
      right: 10px;
      border-top-width: 2px;
      border-right-width: 2px;
    }
    
    .blueprint-corner.bl {
      bottom: 10px;
      left: 10px;
      border-bottom-width: 2px;
      border-left-width: 2px;
    }
    
    .blueprint-corner.br {
      bottom: 10px;
      right: 10px;
      border-bottom-width: 2px;
      border-right-width: 2px;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: rgba(33, 33, 33, 0.8);
      color: #f5f5f5;
      padding: 15px 20px;
      position: relative;
      z-index: 2;
      border-bottom: 1px solid rgba(207, 216, 220, 0.2);
    }
    
    .header-title {
      font-size: 20px;
      flex-grow: 1;
      text-align: center;
      font-weight: bold;
      color: #cfd8dc;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .back-button {
      cursor: pointer;
      font-size: 20px;
      color: #ff9100;
      transition: transform 0.2s ease, color 0.3s ease;
    }
    
    .back-button:hover { 
      transform: scale(1.2) rotate(-30deg); 
      color: #ffb74d;
    }
    
    .placeholder { width: 30px; }
    
    /* Instructions Styles */
    .instructions-content {
      padding: 30px;
      font-family: 'Poppins', sans-serif;
      position: relative;
      z-index: 2;
    }
    
    .instructions-content h2 {
      color: #ff9100;
      text-align: center;
      margin-top: 0;
      margin-bottom: 30px;
      font-size: 28px;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .instructions-text {
      background: rgba(33, 33, 33, 0.7);
      padding: 20px;
      border-radius: 8px;
      border: 1px solid rgba(207, 216, 220, 0.2);
      margin-bottom: 30px;
      line-height: 1.6;
    }
    
    .instructions-text p {
      margin: 15px 0;
    }
    
    .instructions-text ul {
      padding-left: 20px;
    }
    
    .instructions-text li {
      margin: 10px 0;
    }
    
    .component-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin: 30px 0;
    }
    
    .component-item {
      display: flex;
      align-items: center;
      background: rgba(33, 33, 33, 0.7);
      padding: 10px 15px;
      border-radius: 8px;
      border: 1px solid rgba(207, 216, 220, 0.2);
      max-width: 45%;
    }
    
    .component-icon {
      width: 40px;
      height: 40px;
      background: rgba(255, 145, 0, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      color: #ff9100;
      font-weight: bold;
      font-size: 14px;
    }
    
    .component-name {
      font-weight: 600;
      color: #cfd8dc;
      font-size: 14px;
    }
    
    .start-button {
      display: block;
      margin: 30px auto;
      padding: 15px 30px;
      font-size: 18px;
      font-weight: bold;
      background: linear-gradient(45deg, #ff9100, #ff5722);
      color: #f5f5f5;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 15px rgba(255, 145, 0, 0.3);
      transition: all 0.3s ease;
    }
    
    .start-button:hover {
      background: linear-gradient(45deg, #ffb74d, #ff7043);
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(255, 145, 0, 0.4);
    }
    
    h2 {
      text-align: center;
      margin-top: 20px;
      color: #cfd8dc;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      z-index: 2;
    }
    
    .container {
      position: relative;
      width: 100%;
      max-width: 1000px;
      margin: 20px auto;
      aspect-ratio: 16 / 9;
      border: 3px solid #cfd8dc;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      background-color: rgba(33, 33, 33, 0.7);
      animation: fadeIn 1.2s ease forwards;
      position: relative;
      z-index: 2;
    }
    
    .motherboard {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 7px;
    }
    
    .drop-zone {
      position: absolute;
      padding: 5px;
      background-color: rgba(33, 33, 33, 0.7);
      border: 2px dashed #cfd8dc;
      border-radius: 6px;
      font-size: 12px;
      font-weight: bold;
      text-align: center;
      color: #f5f5f5;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .drop-zone:hover {
      background-color: rgba(255, 145, 0, 0.2);
      border-color: #ff9100;
      box-shadow: 0 0 15px rgba(255, 145, 0, 0.5);
    }
    
    .drop-zone.filled {
      font-size: 10px;
      padding: 3px;
    }
    
    .choices {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      animation: fadeIn 1.4s ease forwards;
      position: relative;
      z-index: 2;
    }
    
    .draggable {
      padding: 8px 12px;
      background: linear-gradient(45deg, #cfd8dc, #90a4ae);
      color: #212121;
      border-radius: 4px;
      cursor: grab;
      font-size: 13px;
      font-weight: bold;
      border: 2px solid #cfd8dc;
      user-select: none;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .draggable:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(255, 145, 0, 0.5);
      background: linear-gradient(45deg, #ff9100, #ff5722);
      color: #f5f5f5;
      border-color: #ff9100;
    }
    
    .correct {
      background: linear-gradient(45deg, #4caf50, #8bc34a) !important;
      border-color: #4caf50 !important;
      color: #f5f5f5 !important;
      cursor: default !important;
      animation: magneticSnap 0.5s ease;
    }
    
    @keyframes magneticSnap {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    
    .buttons {
      margin-top: 30px;
      text-align: center;
      animation: fadeIn 1.6s ease forwards;
      position: relative;
      z-index: 2;
    }
    
    .buttons button {
      margin: 10px;
      padding: 12px 25px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
      border: none;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .submit-btn {
      background: linear-gradient(45deg, #cfd8dc, #90a4ae);
      color: #212121;
    }
    
    .submit-btn:hover {
      background: linear-gradient(45deg, #ff9100, #ff5722);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(255, 145, 0, 0.5);
      color: #f5f5f5;
    }
    
    .back-btn {
      background: linear-gradient(45deg, #757575, #424242);
      color: #f5f5f5;
    }
    
    .back-btn:hover {
      background: linear-gradient(45deg, #9e9e9e, #616161);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(207, 216, 220, 0.5);
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Hide game container initially */
    #gameContainer {
      display: none;
    }
    
    /* Mobile responsiveness */
   @media (max-width: 600px) {
    .app-container, .instructions-container { 
      border-radius: 0;
      min-height: 100vh;
      height: auto;
      margin: 0;
      width: 100%;
      max-width: 100%;
    }
      
      .drop-zone { 
        font-size: 10px; 
        width: 18%; 
      }
      
      .drop-zone.filled {
        font-size: 8px;
      }
      
      .draggable { 
        font-size: 12px; 
        padding: 6px 10px;
      }
      
      .header-title { 
        font-size: 16px; 
      }
      
      .buttons button {
        padding: 10px 15px;
        font-size: 14px;
      }
      
      .instructions-content {
        padding: 20px;
      }
      
      .instructions-content h2 {
        font-size: 22px;
      }
      
      .component-item {
        flex-direction: column;
        text-align: center;
        max-width: 100%;
      }
      
      .component-icon {
        margin-right: 0;
        margin-bottom: 10px;
      }
      
      .container {
        border-width: 2px;
      }
    }
  </style>
</head>
<body>
  <div class="blueprint-bg"></div>
  <div class="circuit-pattern"></div>
  
  <!-- Instructions Container -->
  <div class="instructions-container" id="instructionsContainer">
    <div class="blueprint-corner tl"></div>
    <div class="blueprint-corner tr"></div>
    <div class="blueprint-corner bl"></div>
    <div class="blueprint-corner br"></div>
    
    <header>
      <div class="back-button" onclick="confirmBack()">⤺</div>
      <div class="header-title">🧩 Motherboard Component Identification</div>
      <div class="placeholder"></div>
    </header>
    
    <div class="instructions-content">
      <h2>Component Identification Blueprint</h2>
      
      <div class="instructions-text">
        <p>Welcome to the Tech Lab! Your mission is to identify and correctly label the various components on a motherboard.</p>
        
        <h3 style="color: #ff9100; margin-top: 20px;">Mission Briefing:</h3>
        <p>This interactive simulation will test your knowledge of motherboard components and their proper identification.</p>
        
        <h3 style="color: #ff9100; margin-top: 20px;">Components to Identify:</h3>
        <div class="component-list">
          <div class="component-item">
            <div class="component-icon">AGP</div>
            <div class="component-name">AGP 4X/8X slot</div>
          </div>
          <div class="component-item">
            <div class="component-icon">I/O</div>
            <div class="component-name">Rear I/O panel</div>
          </div>
          <div class="component-item">
            <div class="component-icon">PCI</div>
            <div class="component-name">PCI slot</div>
          </div>
          <div class="component-item">
            <div class="component-icon">SATA</div>
            <div class="component-name">SATA Connectors</div>
          </div>
          <div class="component-item">
            <div class="component-icon">PWR</div>
            <div class="component-name">ATX Power Connector</div>
          </div>
        </div>
        
        <h3 style="color: #ff9100; margin-top: 20px;">Instructions:</h3>
        <ul>
          <li>Drag each component label from the selection area to its correct position on the motherboard</li>
          <li>Labels will snap into place with a magnetic animation when correctly positioned</li>
          <li>Hover over drop zones to see them glow orange</li>
          <li>Click Submit when you believe all labels are correctly placed</li>
          <li>Earn points based on the number of correctly identified components</li>
        </ul>
        
        <h3 style="color: #ff9100; margin-top: 20px;">Rewards:</h3>
        <p>Successfully identifying all components will earn you maximum points. Each correctly labeled component contributes to your total score.</p>
      </div>
      
      <button class="start-button" onclick="startGame()">🚀 Start Identification</button>
    </div>
  </div>
  
  <!-- Game Container -->
  <div class="app-container" id="gameContainer">
    <div class="blueprint-corner tl"></div>
    <div class="blueprint-corner tr"></div>
    <div class="blueprint-corner bl"></div>
    <div class="blueprint-corner br"></div>
    
    <header>
      <div class="back-button" onclick="confirmBack()">⤺</div>
      <div class="header-title">🧩 Motherboard Component Identification</div>
      <div class="placeholder"></div>
    </header>
    
    <h2>Label the Motherboard Parts</h2>
    
    <div class="container">
      <img src="images/Mboard.png" class="motherboard" alt="Motherboard Image"/>
      <div class="drop-zone" data-label="AGP 4X/8X slot" style="top: 1%; left: 22%; width: 22%; height: 10%;"></div>
      <div class="drop-zone" data-label="Rear I/O panel" style="top: 1%; left: 49%; width: 22.5%; height: 10%;"></div>
      <div class="drop-zone" data-label="PCI slot" style="top: 48%; left: 2%; width: 16%; height: 12%;"></div>
      <div class="drop-zone" data-label="SATA Connectors" style="top: 67%; left: 4%; width: 16%; height: 12%;"></div>
      <div class="drop-zone" data-label="20-pin ATX Power Connector" style="top: 88%; left: 9%; width: 19%; height: 12%;"></div>
      <div class="drop-zone" data-label="FDD Connector" style="top: 89.5%; left: 30%; width: 16.5%; height: 10.5%;"></div>
      <div class="drop-zone" data-label="IDE/PATA Connector" style="top:89.5%; left: 47.5%; width: 19%; height: 10%;"></div>
      <div class="drop-zone" data-label="4-pin CPU power connector" style="top: 90%; left: 67%; width: 22%; height: 10%;"></div>
      <div class="drop-zone" data-label="CPU Socket" style="top: 61%; left: 80.3%; width: 15.5%;height: 12.5%;"></div>
      <div class="drop-zone" data-label="Memory Slot" style="top: 34%; left: 80%; width: 16%; height: 12%;"></div>
    </div>
    
    <div class="choices">
      <div class="draggable" draggable="true">AGP 4X/8X slot</div>
      <div class="draggable" draggable="true">Rear I/O panel</div>
      <div class="draggable" draggable="true">PCI slot</div>
      <div class="draggable" draggable="true">SATA Connectors</div>
      <div class="draggable" draggable="true">20-pin ATX Power Connector</div>
      <div class="draggable" draggable="true">FDD Connector</div>
      <div class="draggable" draggable="true">IDE/PATA Connector</div>
      <div class="draggable" draggable="true">4-pin CPU power connector</div>
      <div class="draggable" draggable="true">CPU Socket</div>
      <div class="draggable" draggable="true">Memory Slot</div>
    </div>
    
    <div class="buttons">
      <button class="submit-btn" onclick="submitAnswers()">Submit</button>
      <button class="back-btn" onclick="confirmBack()">Back</button>
    </div>
  </div>

<script>
  // Original functionality
  const draggables = document.querySelectorAll('.draggable');
  const dropZones = document.querySelectorAll('.drop-zone');
  let submitted = false;
  
  draggables.forEach(drag => {
    drag.addEventListener('dragstart', e => {
      if (!submitted) {
        e.dataTransfer.setData("text/plain", drag.textContent);
      }
    });
  });
  
  dropZones.forEach(zone => {
    zone.addEventListener('dragover', e => {
      if (!submitted) e.preventDefault();
    });
    zone.addEventListener('drop', e => {
      if (!submitted) {
        e.preventDefault();
        const data = e.dataTransfer.getData("text/plain");
        if (zone.textContent === "") {
          zone.textContent = data;
          zone.classList.add("filled"); // Add class to adjust text size
          zone.setAttribute("data-user", data);
          const dragElement = [...draggables].find(d => d.textContent === data);
          if (dragElement) dragElement.style.display = "none";
          
          // Add magnetic snap animation
          zone.style.animation = "magneticSnap 0.5s ease";
          setTimeout(() => {
            zone.style.animation = "";
          }, 500);
        }
      }
    });
  });
  
  function submitAnswers() {
    let correct = 0;
    let total = dropZones.length;
    dropZones.forEach(zone => {
      const userAnswer = zone.getAttribute("data-user");
      if (userAnswer === zone.dataset.label) {
        zone.classList.add("correct");
        correct++;
      } else {
        zone.textContent = `${userAnswer || "Empty"}\n→ ${zone.dataset.label}`;
      }
    });
    const score = correct * 200;
    const coins = correct * 20;
    
    setTimeout(() => {
      if (correct === total) {
        alert(`🎉 Perfect! You scored ${score} points and earned ${coins} coins.`);
        // Send reward to server
        sendReward(score, coins);
      } else {
        alert(`You got ${correct} out of ${total} correct.\nScore: ${score} points and ${coins} coins.`);
        // Send partial reward to server
        sendReward(score, coins);
      }
    }, 100);
    submitted = true;
  }
  
  function sendReward(points, coins) {
    const username = localStorage.getItem("loggedInUser") || "Guest";
    
    fetch("https://postgres-test-p05s.onrender.com/api/reward", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ 
        username, 
        points, 
        coins,
        reason: "Motherboard Component Identification"
      })
    })
    .then(res => res.json())
    .then(data => {
      if (data.success) {
        console.log("Reward sent successfully");
      } else {
        console.error("Failed to send reward:", data);
      }
    })
    .catch(err => {
      console.error("Error sending reward:", err);
    });
  }
  
  function confirmBack() {
    if (confirm("Are you sure you want to quit? Progress will be lost.")) {
      window.location.href = "../levels/systemunitlevel.html";
    }
  }
  
  function startGame() {
    document.getElementById('instructionsContainer').style.display = 'none';
    document.getElementById('gameContainer').style.display = 'flex';
  }
  // === 🎵 SYSTEM UNIT LAB AMBIENCE ===
let sysAudioCtx, sysMasterGain, sysIntervals = [];

function startSystemUnitMusic() {
  if (sysAudioCtx) return; // already playing

  sysAudioCtx = new (window.AudioContext || window.webkitAudioContext)();
  sysMasterGain = sysAudioCtx.createGain();
  sysMasterGain.gain.value = 0.6; // 🎚 lower ambient volume
  sysMasterGain.connect(sysAudioCtx.destination);

  // 🔹 Ambient low hum (feels like PC fans or lab machines running)
  sysIntervals.push(setInterval(() => {
    playToneSys(80, "sawtooth", 2, 0.15);
  }, 2000));

  // 🔹 Random digital beeps (assembly scanner sounds)
  sysIntervals.push(setInterval(() => {
    let freqs = [523, 659, 784, 988]; // high-tech tones
    let freq = freqs[Math.floor(Math.random() * freqs.length)];
    playToneSys(freq, "triangle", 0.2, 0.25);
  }, 1200));

  // 🔹 Metallic click / clank (like snapping PC parts in)
  sysIntervals.push(setInterval(() => {
    playClickSys();
  }, 2500));
}

// === SOUND HELPERS ===
function playToneSys(freq, type, duration, volume) {
  const osc = sysAudioCtx.createOscillator();
  const gain = sysAudioCtx.createGain();
  gain.gain.value = volume;
  osc.type = type;
  osc.frequency.value = freq;
  osc.connect(gain);
  gain.connect(sysMasterGain);

  osc.start();
  osc.stop(sysAudioCtx.currentTime + duration);
}

function playClickSys() {
  const bufferSize = sysAudioCtx.sampleRate * 0.05;
  const buffer = sysAudioCtx.createBuffer(1, bufferSize, sysAudioCtx.sampleRate);
  const data = buffer.getChannelData(0);

  for (let i = 0; i < bufferSize; i++) {
    data[i] = Math.random() * 2 - 1; // noise
  }

  const noise = sysAudioCtx.createBufferSource();
  noise.buffer = buffer;

  const gain = sysAudioCtx.createGain();
  gain.gain.value = 0.2;
  noise.connect(gain);
  gain.connect(sysMasterGain);

  noise.start();
  noise.stop(sysAudioCtx.currentTime + 0.05);
}

// === STOP ===
function stopSystemUnitMusic() {
  sysIntervals.forEach(id => clearInterval(id));
  sysIntervals = [];
  if (sysAudioCtx) {
    sysAudioCtx.close();
    sysAudioCtx = null;
  }
}

// === AUTO START ===
window.addEventListener("load", () => {
  // Some browsers require a user interaction — this ensures auto-start after first click
  document.body.addEventListener("click", () => {
    if (!sysAudioCtx) startSystemUnitMusic();
  }, { once: true });

  // If autoplay is allowed, try directly
  startSystemUnitMusic();
});
</script>
</body>
</html>